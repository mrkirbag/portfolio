<div id="vanta-canvas"></div>
<div class="bg-stars" id="bg-stars"></div>

<script is:inline src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script is:inline src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.fog.min.js"></script>

<script is:inline>
    function initVanta() {
        if (window.VANTA) {
        window.VANTA.FOG({
            el: "#vanta-canvas",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            highlightColor: 0x1b0049,
            midtoneColor: 0x210068,
            lowlightColor: 0x33133f,
            baseColor: 0x492177,
            blurFactor: 0.44,
            speed: 2.40,
            zoom: 1.40
        });
        }
    }

    function createStars() {
        const starCount = 120;
        const stars = document.getElementById('bg-stars');
        if (!stars) return;
        stars.innerHTML = '';
        const starElements = [];
        for (let i = 0; i < starCount; i++) {
            const star = document.createElement('div');
            star.style.position = 'absolute';
            star.style.width = '2px';
            star.style.height = '2px';
            star.style.borderRadius = '50%';
            star.style.background = 'white';
            star.style.opacity = (Math.random() * 0.8 + 0.2).toString();
            star.style.left = Math.random() * window.innerWidth + 'px';
            star.style.top = Math.random() * window.innerHeight + 'px';
            stars.appendChild(star);
            starElements.push({
                el: star,
                speed: Math.random() * 0.5 + 0.2,
                x: parseFloat(star.style.left),
                y: parseFloat(star.style.top)
            });
        }
        function animateStars() {
            for (const star of starElements) {
                star.x += star.speed;
                if (star.x > window.innerWidth) {
                    star.x = 0;
                    star.y = Math.random() * window.innerHeight;
                }
                star.el.style.left = star.x + 'px';
                star.el.style.top = star.y + 'px';
            }
            requestAnimationFrame(animateStars);
        }
        animateStars();
    }

    initVanta();
    createStars();
    document.addEventListener('astro:after-swap', () => {
        initVanta();
        createStars();
    });
</script>

<style>
    #vanta-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -2; /* Se mantiene al fondo */
        pointer-events: none;
    }
    .bg-stars {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: -1;
        pointer-events: none;
    }
</style>